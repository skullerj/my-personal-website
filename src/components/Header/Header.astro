---
import { LOGO_IMAGE, SITE } from "@config";
import Hr from "../Hr.astro";
import LinkButton from "../LinkButton.astro";
import HamburgerMenu from "./HamburgerMenu.astro";
import NavMenu from "./NavMenu.astro";

export interface Props {
  activeNav?: "posts" | "tags" | "about" | "search";
}

const { activeNav } = Astro.props;
---

<header>
  <a
    id="skip-to-content"
    href="#main-content"
    class="absolute -top-full left-17 z-50 bg-skin-accent px-3 py-2 text-skin-inverted transition-all focus:top-4"
    >Skip to content</a
  >
  <div
    class="mx-auto flex max-w-3xl flex-col items-center justify-between sm:flex-row"
  >
    <div
      class="relative flex w-full items-start justify-between p-4 sm:items-center sm:py-8"
    >
      <a
        href="/"
        class="absolute font-semibold sm:static flex flex-col text-xl sm:text-2xl whitespace-nowrap"
      >
        {
          LOGO_IMAGE.enable ? (
            <img
              src={`/assets/${LOGO_IMAGE.svg ? "logo.svg" : "logo.png"}`}
              alt={SITE.title}
              width={LOGO_IMAGE.width}
              height={LOGO_IMAGE.height}
            />
          ) : (
            SITE.title
          )
        }
        <span class="text-sm text-skin-accent">By {SITE.author}</span>
      </a>
      <NavMenu activeNav={activeNav} />
    </div>
  </div>
  <Hr />
</header>

<script>
  function toggleNav() {
    // Toggle menu
    const menuBtn = document.querySelector(".hamburger-menu");
    const menuIcon = document.querySelector(".menu-icon");
    const menuItems = document.querySelector("#menu-items");

    menuBtn?.addEventListener("click", () => {
      const menuExpanded = menuBtn.getAttribute("aria-expanded") === "true";
      menuIcon?.classList.toggle("is-active");
      menuBtn.setAttribute("aria-expanded", menuExpanded ? "false" : "true");
      menuBtn.setAttribute(
        "aria-label",
        menuExpanded ? "Open Menu" : "Close Menu",
      );
      menuItems?.classList.toggle("display-none");
    });
  }

  toggleNav();

  // Runs on view transitions navigation
  document.addEventListener("astro:after-swap", toggleNav);
</script>
